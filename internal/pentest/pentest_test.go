package pentest

import (
	"testing"

	"github.com/stretchr/testify/require"
)

func TestPentestScanDefaults(t *testing.T) {
	scan := &PentestScan{
		AppName:    "test-app",
		Path:       "/path/to/spec.yaml",
		TargetHost: "https://api.example.com",
	}

	require.False(t, scan.Local, "local should default to false")
	require.Empty(t, scan.ImageLabel)
	require.False(t, scan.ForcePullImage)
	require.False(t, scan.UseHostNetwork)
	require.Empty(t, scan.AuthConfig)
	require.Empty(t, scan.AuthHeaders)
}

func TestPentestScanLocalSettings(t *testing.T) {
	scan := &PentestScan{
		AppName:          "test-app",
		Path:             "/path/to/spec.yaml",
		TargetHost:       "http://localhost:8080",
		GitHubOwner:      "org",
		GitHubRepository: "repo",
		Local:            true,
		ImageLabel:       "v2.1.0",
		ForcePullImage:   true,
		UseHostNetwork:   true,
	}

	require.True(t, scan.Local)
	require.Equal(t, "v2.1.0", scan.ImageLabel)
	require.True(t, scan.ForcePullImage)
	require.True(t, scan.UseHostNetwork)
}
