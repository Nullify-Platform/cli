// Code generated by scripts/generate/main.go. DO NOT EDIT.
package commands

import (
	"net/url"

	"github.com/nullify-platform/cli/internal/api"
	"github.com/nullify-platform/cli/internal/output"
	"github.com/spf13/cobra"
	"github.com/spf13/pflag"
)

func RegisterCspmCommands(parent *cobra.Command, getClient func() *api.Client) {
	serviceCmd := &cobra.Command{
		Use:   "cspm",
		Short: "Cspm commands",
	}
	parent.AddCommand(serviceCmd)

	{
		cmd := &cobra.Command{
			Use:   "list-findings",
			Short: "Get CSPM Findings",
			RunE: func(cmd *cobra.Command, args []string) error {
				client := getClient()
				params := url.Values{}
				cmd.Flags().Visit(func(f *pflag.Flag) {
					params.Set(f.Name, f.Value.String())
				})
				result, err := client.ListCspmFindings(cmd.Context(), params)
				if err != nil {
					return err
				}
				return output.Print(cmd, result)
			},
		}
		cmd.Flags().String("azureOrganizationId", "", "The Azure organization ID")
		cmd.Flags().String("bitbucketWorkspaceId", "", "The Bitbucket workspace ID")
		cmd.Flags().String("githubOwnerId", "", "The Github owner ID")
		cmd.Flags().String("gitlabGroupId", "", "The GitLab group ID")
		cmd.Flags().String("installationId", "", "The Nullify installation ID")
		cmd.Flags().String("azureRepositoryId", "", "")
		cmd.Flags().String("githubRepositoryId", "", "")
		cmd.Flags().String("githubTeamId", "", "")
		cmd.Flags().String("bitbucketRepositoryId", "", "")
		cmd.Flags().String("limit", "", "Maximum number of findings to return")
		cmd.Flags().String("nextToken", "", "Token for pagination")
		cmd.Flags().String("sort", "", "Sort order (asc or desc)")
		cmd.Flags().String("sortBy", "", "Field to sort by (priority, time, severity)")
		cmd.Flags().String("severity", "", "Filter by severity")
		cmd.Flags().String("status", "", "Filter by status")
		cmd.Flags().String("accountId", "", "Filter by account ID")
		cmd.Flags().String("region", "", "Filter by region")
		cmd.Flags().String("resourceType", "", "Filter by resource type")
		cmd.Flags().String("scanId", "", "Filter by scan ID")
		serviceCmd.AddCommand(cmd)
	}

	{
		cmd := &cobra.Command{
			Use:   "get-findings",
			Short: "Get CSPM Finding",
			Args: cobra.MaximumNArgs(1),
			RunE: func(cmd *cobra.Command, args []string) error {
				client := getClient()
				params := url.Values{}
				cmd.Flags().Visit(func(f *pflag.Flag) {
					params.Set(f.Name, f.Value.String())
				})
				if len(args) > 0 {
					params.Set("findingId", args[0])
				}
				result, err := client.GetCspmFindingsFindingId(cmd.Context(), params)
				if err != nil {
					return err
				}
				return output.Print(cmd, result)
			},
		}
		cmd.Flags().String("azureOrganizationId", "", "The Azure organization ID")
		cmd.Flags().String("bitbucketWorkspaceId", "", "The Bitbucket workspace ID")
		cmd.Flags().String("githubOwnerId", "", "The Github owner ID")
		cmd.Flags().String("gitlabGroupId", "", "The GitLab group ID")
		cmd.Flags().String("installationId", "", "The Nullify installation ID")
		cmd.Flags().String("azureRepositoryId", "", "")
		cmd.Flags().String("githubRepositoryId", "", "")
		cmd.Flags().String("githubTeamId", "", "")
		cmd.Flags().String("bitbucketRepositoryId", "", "")
		serviceCmd.AddCommand(cmd)
	}

	{
		cmd := &cobra.Command{
			Use:   "list-scans",
			Short: "Get CSPM Scans",
			RunE: func(cmd *cobra.Command, args []string) error {
				client := getClient()
				params := url.Values{}
				cmd.Flags().Visit(func(f *pflag.Flag) {
					params.Set(f.Name, f.Value.String())
				})
				result, err := client.ListCspmScans(cmd.Context(), params)
				if err != nil {
					return err
				}
				return output.Print(cmd, result)
			},
		}
		cmd.Flags().String("azureOrganizationId", "", "The Azure organization ID")
		cmd.Flags().String("bitbucketWorkspaceId", "", "The Bitbucket workspace ID")
		cmd.Flags().String("githubOwnerId", "", "The Github owner ID")
		cmd.Flags().String("gitlabGroupId", "", "The GitLab group ID")
		cmd.Flags().String("installationId", "", "The Nullify installation ID")
		cmd.Flags().String("azureRepositoryId", "", "")
		cmd.Flags().String("githubRepositoryId", "", "")
		cmd.Flags().String("githubTeamId", "", "")
		cmd.Flags().String("bitbucketRepositoryId", "", "")
		cmd.Flags().String("limit", "", "Maximum number of scans to return")
		cmd.Flags().String("nextToken", "", "Token for pagination")
		cmd.Flags().String("status", "", "Filter by scan status")
		cmd.Flags().String("accountId", "", "Filter by account ID")
		cmd.Flags().String("region", "", "Filter by region")
		cmd.Flags().String("scanType", "", "Filter by scan type")
		serviceCmd.AddCommand(cmd)
	}

	{
		cmd := &cobra.Command{
			Use:   "get-scans",
			Short: "Get CSPM Scan",
			Args: cobra.MaximumNArgs(1),
			RunE: func(cmd *cobra.Command, args []string) error {
				client := getClient()
				params := url.Values{}
				cmd.Flags().Visit(func(f *pflag.Flag) {
					params.Set(f.Name, f.Value.String())
				})
				if len(args) > 0 {
					params.Set("scanId", args[0])
				}
				result, err := client.GetCspmScansScanId(cmd.Context(), params)
				if err != nil {
					return err
				}
				return output.Print(cmd, result)
			},
		}
		cmd.Flags().String("azureOrganizationId", "", "The Azure organization ID")
		cmd.Flags().String("bitbucketWorkspaceId", "", "The Bitbucket workspace ID")
		cmd.Flags().String("githubOwnerId", "", "The Github owner ID")
		cmd.Flags().String("gitlabGroupId", "", "The GitLab group ID")
		cmd.Flags().String("installationId", "", "The Nullify installation ID")
		cmd.Flags().String("azureRepositoryId", "", "")
		cmd.Flags().String("githubRepositoryId", "", "")
		cmd.Flags().String("githubTeamId", "", "")
		cmd.Flags().String("bitbucketRepositoryId", "", "")
		serviceCmd.AddCommand(cmd)
	}

}
